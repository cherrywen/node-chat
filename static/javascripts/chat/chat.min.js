$(function(){function e(){var e=new Date,t=e.getFullYear(),n=10>e.getMonth()+1?"0"+(e.getMonth()+1):e.getMonth()+1,a=10>e.getDate()?"0"+e.getDate():e.getDate(),s=10>e.getHours()?"0"+e.getHours():e.getHours(),o=10>e.getMinutes()?"0"+e.getMinutes():e.getMinutes(),i=10>e.getSeconds()?"0"+e.getSeconds():e.getSeconds();return t+"-"+n+"-"+a+" "+s+":"+o+":"+i}var t=io.connect("/"),n=$("#showUsers"),a=[],s=null;$(".setUser").click(function(){var e=$("#userName").val();e?(dataObj={name:e},t.emit("login",dataObj),$(".loginForm").hide(),$(".fade").hide(),$(".userName").val("")):alert("昵称不能为空！！!")}),$("#sendMsg").click(function(){var n=$("#chatMsg").val();if(n){var a={name:s.name,msg:n,time:e()};t.emit("sendMessage",a),$("#chatMsg").val("")}else alert("内容不能为空！！！")}),t.on("user",function(e){s=e}),t.on("users",function(e){a=e;var t="";_.each(a,function(e){t+='<div class="showUsers">'+e.name+"</div>"}),n.html("").append(t)}),t.on("sendMessage",function(e){var t='<div><span class="chatUser">'+e.name+"@"+e.time+' : </span><span class="chatMessage">'+e.msg+"</span></div>";$("#chatInformation").append(t)})});